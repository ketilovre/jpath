!function(a,b){"use strict";"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module&&"object"==typeof exports?module.exports=b():a.roam=b()}(this,function(){"use strict";function a(a){var b,c=-1,d=[];if(!a)return[];for(var e=a.split(".");++c<e.length;)b="*"===e[c].charAt(0),d.push({type:b?"deep":"shallow",identifier:b?e[c].slice(1):e[c]});return d}function b(a,b,c){var d,e=[];if(b instanceof Array||!b.hasOwnProperty(a))a:for(var f=0,g=b.length;g>f;f++){if(d=b[f],d.hasOwnProperty(a))e.push(d[a]);else if(d instanceof Array){for(var h=0,i=d.length;i>h;h++)if(d[h].hasOwnProperty(a)&&(e.push(d[h][a]),c))break a}else+a===f&&e.push(d);if(c&&e.length)break}else e.push(b[a]);return e}function c(a,b,c){function d(b){if(!c||!e.length)if(b instanceof Array)for(var f=0,g=b.length;g>f;f++)d(b[f]);else if(null!==b&&"object"==typeof b){b.hasOwnProperty(a)&&e.push(b[a]);for(var h in b)h!==a&&null!==b[h]&&"object"==typeof b[h]&&d(b[h])}}var e=[];return d(b),e}function d(a,d,e){for(var f,g,h=d;a.length;){if(g=a.shift(),f=[],"shallow"===g.type)f=b(g.identifier,h,e);else if(h instanceof Array)for(var i=0,j=h.length;j>i;i++)f=f.concat(c(g.identifier,h[i],e));else if(null!==h&&"object"==typeof h)for(var k in h)h.hasOwnProperty(k)&&(f=f.concat(c(g.identifier,h[k],e)));h=f}return h}function e(a,b,c,d){return c===a[0].identifier?1===a.length?d(b):f(b,a.slice(1),d):null===b||"object"!=typeof b||"deep"!==a[0].type&&"number"!=typeof c?b:f(b,a,d)}function f(a,b,c){var d;if(a instanceof Array){d=[];for(var f=0,g=a.length;g>f;f++)d[f]=e(b,a[f],f,c)}else{d={};for(var h in a)a.hasOwnProperty(h)&&(d[h]=e(b,a[h],h,c))}return d}function g(a){"string"==typeof a&&(a=JSON.parse(a)),this.json=a}return g.prototype.get=function(b){return d(a(b),this.json)},g.prototype.one=function(b){return d(a(b),this.json,!0)[0]},g.prototype.transform=function(b,c){var d=a(b);return c&&d.length?f(this.json,d,c):this.json},g.prototype.has=function(a){return void 0!==this.one(a)},g.prototype.count=function(a){return this.get(a).length},g.prototype.filter=function(a,b){var c,d=[];c=this.get(a);for(var e=0,f=c.length;f>e;e++)b(c[e],e,c)&&d.push(c[e]);return d},g.prototype.map=function(a,b){var c,d=[];c=this.get(a);for(var e=0,f=c.length;f>e;e++)d.push(b(c[e],e,c));return d},function(a){return new g(a)}});